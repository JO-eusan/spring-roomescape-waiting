# 🚪방탈출 사용자 예약 애플리케이션

`RoomescapeApplication`에서 실행 가능합니다.

### 관리자 페이지

* http://localhost:8080/admin/time: 사용자가 예약할 수 있는 시간 관리 페이지
* http://localhost:8080/admin/theme: 사용자가 이용할 수 있는 방탈출 테마 관리 페이지
* http://localhost:8080/admin/reservation: 사용자 예약 관리 페이지

### 사용자 페이지

* http://localhost:8080/: 사용자 예약 기준으로 탑10 방탈출 테마 확인 페이지
* http://localhost:8080/reservation: 사용자가 예약을 할 수 있는 페이지
* http://localhost:8080/signup: 사용자가 회원가입을 할 수 있는 페이지
* http://localhost:8080/login: 사용자가 로그인을 할 수 있는 페이지

## 요구사항 분석

### 1. 예외 처리

- [x] 시간 생성 시 시작 시간에 유효하지 않은 값이 입력되었을 때
    - [x] null이 들어오면 예외가 발생한다.
    - [x] 이미 존재하는 시간은 등록할 수 없다.
- [x] 테마 생성 시 테마 이름, 테마 설명, 썸네일에 유효하지 않은 값이 입력되었을 때
    - [x] null이 들어오면 예외가 발생한다.
    - [x] 이미 존재하는 테마 이름이라면 예외가 발생한다.
- [x] 예약 생성 시 예약자명, 날짜, 시간, 테마에 유효하지 않은 값이 입력 되었을 때
    - [x] 값중에 하나라도 null이 들어오면 예외가 발생한다.
    - [x] 등록되지 않은 시간인 경우 예외가 발생한다.
- [x] 아래와 같은 서비스 정책을 반영
    - [x] 사용자는 지나간 날짜와 시간에 대한 예약 생성이 불가능하다.
    - [x] 중복 예약은 불가능하다.
    - [x] 특정 시간에 대한 예약이 존재하면 그 시간은 삭제가 불가능하다.
    - [x] 특정 테마에 대한 예약이 존재하면 그 테마는 삭제가 불가능하다.

### 2. 예외 응답

- [x] null, 생성할 때의 예외는 BadRequest로 응답한다.
- [x] 중복, 삭제할 때의 예외는 Conflict로 응답한다.

### 3. 테마 선택 기능

- [x] `/admin/theme` 요청 시 테마 관리 페이지를 응답
- [x] 테마 조회 기능 응답
- [x] 테마 추가 기능 응답
- [x] 테마 삭제 기능 응답

### 4. 사용자 예약 기능

- [x] 사용자가 예약 가능한 시간을 조회하고 예약할 수 있다.
    - [x] 사용자는 날짜와 테마를 선택하면 예약 가능한 시간을 조회
    - [x] 예약 가능한 시간을 확인하고, 원하는 시간에 예약 추가
    - [x] `/reservation` 요청 시 사용자 예약 페이지 응답
- [x] 인기 테마 조회할 수 있다.
    - [x] 최근 일주일을 기준으로 해당 기간 내에 방문하는 예약이 많은 테마 10개를 확인
    - [x] 오늘 날짜 이전으로 일주일 (4월 8일인 경우, 게임 날짜가 4월 1일부터 4월 7일까지)
    - [x] `/` 요청 시 인기 테마 페이지를 응답

### 5. 사용자 로그인

- [x] 사용자는 회원가입을 할 수 있다.
- [x] 사용자는 name, email, password를 가진다.
    - [x] email을 로그인 ID로, password를 비밀번호로 사용
- [x] `GET /login` 요청 시 로그인 폼이 있는 페이지를 응답한다.
- [x] `POST /login` 요청 시 로그인 폼에 입력한 email, password 값을 body에 포함한다.
    - [x] 응답은 Cookie에 token 값으로 토큰이 포함되어야 한다.
- [x] 상단바 우측 로그인 상태를 표현해주기 위해 사용자 정보를 조회할 수 있다.
    - [x] Cookie를 이용하여 로그인 사용자의 정보를 확인

### 관리자 기능

- [x] 어드민 페이지 진입은 `admin` 권한이 있는 사람만 접근할 수 있다.
- [x] 관리자가 조건에 따라 예약을 검색할 수 있다.
  - [x] 예약자, 테마, 날짜별 검색 조건을 사용

---

## API 목록

### 홈(Home)

| URL         | 메서드 | 기능           |
|-------------|-----|--------------|
| `/`         | GET | 인기 테마 페이지 보기 |
| `/top-rank` | GET | 인기 테마 조회     |

### 관리자(Admin)

| URL                    | 메서드    | 기능              |
|------------------------|--------|-----------------|
| `/admin`               | GET    | 어드민 페이지 보기      |
| `/admin/reservation`   | GET    | 예약 관리 페이지 보기    |
| `/admin/time`          | GET    | 예약 시간 관리 페이지 보기 |
| `/admin/theme`         | GET    | 테마 관리 페이지 보기    |
| `/admin/reservations`  | POST   | 예약 추가           |
| `/reservations/{id}`   | DELETE | 예약 삭제           |
| `/reservations/filter` | GET    | 예약 필터링 조회       |
| `/members`             | GET    | 사용자 모두 조회       |
| `/times`               | GET    | 예약 가능 시간 모두 조회  |
| `/times`               | POST   | 예약 시간 추가        |
| `/times/{id}`          | DELETE | 예약 시간 삭제        |
| `/themes`              | POST   | 테마 추가           |
| `/themes/{id}`         | DELETE | 테마 삭제           |

### 사용자(User)

| URL                       | 메서드  | 기능               |
|---------------------------|------|------------------|
| `/reservation`            | GET  | 사용자 예약 페이지 보기    |
| `/reservations`           | POST | 사용자 페이지에서 예약 추가  |
| `/times/{date}/{themeId}` | GET  | 예약 가능한 상태의 시간 조회 |
| `/members`                | POST | 사용자 회원가입 추가      |
| `/signup`                 | GET  | 사용자 회원가입 페이지 보기  |
| `/login`                  | GET  | 사용자 로그인 페이지 보기   |
| `/login`                  | POST | 사용자 로그인 후 토큰 생성  |
| `/login/check`            | GET  | 사용자 인증 정보 확인     |
| `/logout`                 | POST | 사용자 로그아웃 후 토큰 만료 |

### Common

| URL             | 메서드 | 기능       |
|-----------------|-----|----------|
| `/reservations` | GET | 예약 목록 조회 |
| `/themes`       | GET | 테마 조회    |

### 예외 응답 형태

```
{
  "timestamp": "2025-05-01T13:55:28.074+00:00",
  "code": "NOT_FOUND",
  "message": "해당 정보를 찾을 수 없습니다: theme"
}
```
